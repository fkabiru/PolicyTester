server {

  listen 80;
  sendfile on;
  keepalive_timeout  60;
  default_type application/octet-stream;
  real_ip_header     X-Forwarded-For;
  set_real_ip_from   0.0.0.0/0;
  server_tokens off;

  gzip on;
  gzip_http_version 1.1;
  gzip_disable      "MSIE [1-6]\.";
  gzip_min_length   256;
  gzip_vary         on;
  gzip_proxied      expired no-cache no-store private auth;
  gzip_types        text/plain text/css application/json application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript;
  gzip_comp_level   9;
  gzip_buffers 32 8k;

  root /usr/share/nginx/html;
  index index.html index.htm;

  location / {

    add_header X-Frame-Options "DENY" always;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Referrer-Policy "no-referrer-when-downgrade";
    add_header Content-Security-Policy "default-src * data: 'unsafe-eval' 'unsafe-inline'" always;

    try_files $uri $uri/ /index.html =404;
    expires -1;
    access_log     off;
    log_not_found  off;
  }

  location /api {
     proxy_pass http://account-statement-backend-svc:8082;
  }

  location ~* \.(?:css|js)$ {
    access_log        off;
    log_not_found     off;
    add_header        Cache-Control "no-cache, public, must-revalidate, proxy-revalidate";
  }

  location ~* \.(?:jpg|jpeg|gif|png|ico|xml|webp|svg)$ {
    access_log        off;
    log_not_found     off;
    expires           60m;
    add_header        Cache-Control "public";
  }

  location ~* \.(?:eot|woff|woff2|ttf|svg|otf) {
    access_log        off;
    log_not_found     off;
    expires           60m;
    add_header        Cache-Control "public";
    add_header        Access-Control-Allow-Origin *;
    types     {font/opentype otf;}
    types     {application/vnd.ms-fontobject eot;}
    types     {font/truetype ttf;}
    types     {application/font-woff woff;}
    types     {font/x-woff woff2;}
    types     {image/svg+xml svg svgz;}
  }

  location ~ /\. {
    access_log        off;
    log_not_found     off;
    deny              all;
  }

}
